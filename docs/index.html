
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Welcome to the LBweights documentation! &#8212; LBweights  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="welcome-to-the-lbweights-documentation">
<h1>Welcome to the LBweights documentation!<a class="headerlink" href="#welcome-to-the-lbweights-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
<section id="lattice-boltzmann-weights">
<h1>Lattice-Boltzmann-weights<a class="headerlink" href="#lattice-boltzmann-weights" title="Permalink to this headline">¶</a></h1>
<p>“LBweights.py” is a Python script that calculates the weights of the (user-supplied) shells of a Lattice Boltzmann model on a simple cubic lattice, based upon numerically solving the Maxwell-Boltzmann constraint (MBC) equations. The script supports arbitrary spacial dimensions and arbitrary tensor ranks up to which the MBCs must hold. The script requires a Python installation (version 3.5 or 2.7) as well as NumPy. It assumes that the speed of sound is a free parameter and hence needs more shells than a model whose speed of sound takes on a definite value that is required for consistency. The output is typically given in the form: weights as a function of sound speed. There are cases where the supplied set of velocities does not admit any solution; in this case the script aborts. There are also cases where it admits infinitely many solutions; in this case an additional script “Continue.py” is used, which builds upon data that the main script stores on file.</p>
<p>In case of a unique solution, the script also calculates the interval(s) of sound speed for which all the weights are positive. At the borders of these intervals, at least one of the weights is zero, such that the corresponding shell may be discarded and one obtains a “reduced model”. In this way, the script is able to reproduce well-known models like D2Q9, D3Q19, D3Q15, etc., but can also easily find higher-order models with significantly more speeds.</p>
<p>For Continue.py, the user has to supply a well-defined value of the sound speed (or an interval plus step size for scanning several values). Moreover, it requires the specification of a shell (or of a set of shells) whose weight (or sum of weights) is to be minimized. Continue.py then finds an optimal solution to the thus-specified linear programming problem. Continue.py therefore requires the package cvxpy, see <a class="reference external" href="http://www.cvxpy.org/">http://www.cvxpy.org/</a> .</p>
<p>A significant part of the code is not in the main scripts but rather in a collection of functions in “Functions.py”, which must be available to “LBweights.py” and “Continue.py”.</p>
<p>Tedious tasks like the construction of velocity shells from the velocity modulus are done by the script.</p>
<p>Apart from being useful for researchers and practitioners, the script may perhaps also be used in a classroom setting.</p>
<p>A detailed description of the underlying mathematical theory, together with illustrative examples, is given in the
paper “Semi-automatic construction of Lattice Boltzmann models” by Dominic Spiller and Burkhard Duenweg, see <a class="reference external" href="http://arxiv.org/abs/2004.03509">http://arxiv.org/abs/2004.03509</a> (original at Physical Review E, <a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.101.043310">https://journals.aps.org/pre/abstract/10.1103/PhysRevE.101.043310</a> / open access).</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/BDuenweg/Lattice-Boltzmann-weights.git
$ virtualenv venv
$ source venv/bin/activate
$ cd Lattice-Boltzmann-weights
$ pip install -r requirements.txt
</pre></div>
</div>
</section>
</section>
<section id="lbweights-py">
<h1>LBweights.py<a class="headerlink" href="#lbweights-py" title="Permalink to this headline">¶</a></h1>
<p>Calculation of the weights of an LB model. You can either supply the input
data interactively or by the following command line arguments:</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>LBweights.py [-h] [-d D] [-m M] [-c C [C ...]] [-s S]
                    [-y] [--test] [--quiet] [--write-latex]

optional arguments:
  -h, --help     show this help message and exit
  -d D           spacial dimension of the lattice
  -m M           Maximum tensor rank
  -c C [C ...]   Space separated list of the radii c_i^2 of
                 the desired velocity shells
  -s S           Random number generator seed
  -y             Answer all prompts with yes (may overwrite
                 file data.npz)
  --test         Test, whether a set of weights that can be
                 written as a linear parametric equation
                 w = w_0 + lambda_1 w_1 + lambda_2 w_2
                 solves the equation A.w == b for given
                 speed of sound.
                 Weights and speed of sound are entered
                 interactively by the user.
  --quiet        Turn off most of the output
  --write-latex  Write unique solution to the file
                 &quot;latex_tables.dat&quot; in form of a latex
                 table. This will append to any existing
                 file.
</pre></div>
</div>
<span class="target" id="module-LBweights"></span><p>Calculate LB model vectors and weights for a simple
cubic lattice of arbitrary dimension</p>
<p>The method is described in D. Spiller’s and B. Duenweg’s paper
“Semi-automatic construction of Lattice Boltzmann models”
Therefore explanations in the code are not very detailed</p>
<dl class="simple">
<dt>Exit codes:</dt><dd><ul class="simple">
<li><p>0:   System has unique solution</p></li>
<li><p>1:   System has no solution</p></li>
<li><p>2:   System is underdetermined and requires further examination</p></li>
<li><p>3:   System has unique solution but there is no physically valid range of
existence</p></li>
<li><p>127: General error</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="LBweights.Analysis">
<span class="sig-prename descclassname"><span class="pre">LBweights.</span></span><span class="sig-name descname"><span class="pre">Analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SpacialDimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxTensorRank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfTensorDimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GrandTotalList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Arguments</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/LBweights.html#Analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#LBweights.Analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the analysis for a given set of parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SpacialDimension</strong> (<em>int</em>) – Spacial dimension</p></li>
<li><p><strong>MaxTensorRank</strong> (<em>int</em>) – Maximum tensor rank <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/></p></li>
<li><p><strong>ListOfTensorDimensions</strong> (<em>list</em>) – List of the dimensions of tensor space
for tensors of rank <img class="math" src="_images/math/1f5276042aa372366e59546d60bf462ea62d1ce4.png" alt="2,4,\dots, M"/>.</p></li>
<li><p><strong>GrandTotalList</strong> (<em>list</em>) – List of lists. The <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>-th sublist
contains all velocity vectors of shell <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>.</p></li>
<li><p><strong>Arguments</strong> (<em>dict</em>) – Dictionary of arguments as returned by function
ParseArguments()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Return codes:</dt><dd><ul class="simple">
<li><p>0:   System has unique solution</p></li>
<li><p>1:   System has no solution</p></li>
<li><p>2:   System is underdetermined and requires further examination</p></li>
<li><p>3:   System has unique solution but there is no physically
valid range of existence</p></li>
<li><p>127: General error</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="LBweights.GetInputData">
<span class="sig-prename descclassname"><span class="pre">LBweights.</span></span><span class="sig-name descname"><span class="pre">GetInputData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Arguments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfThrowawayStrings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/LBweights.html#GetInputData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#LBweights.GetInputData" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command line arguments. You can optionally give a list with the
subshells that you want to discard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arguments</strong> (<em>dict</em>) – Dictionary of command line arguments. This is
useful, if the function is used in an automated script that does
not rely on user input.</p></li>
<li><p><strong>ListOfThrowawayStrings</strong> (<em>list</em>) – List of indices of the subshells to be
discarded. This is useful, if the function is used in an automated
script that does not rely on user input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(SpacialDimension,</span> <span class="pre">MaxTensorRank,</span>
<span class="pre">ListOfTensorDimensions,</span> <span class="pre">GrandTotalList,</span> <span class="pre">Arguments)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="continue-py">
<h1>Continue.py<a class="headerlink" href="#continue-py" title="Permalink to this headline">¶</a></h1>
<p>Find optimal weights for an underdetermined problem. This requires the file
<code class="docutils literal notranslate"><span class="pre">data.npz</span></code> to be present in the directory that can be written by
<code class="docutils literal notranslate"><span class="pre">LBweights.py</span></code> if an underdetermined problem is encountered.
You can either supply the input data interactively or by the following command
line arguments:</p>
<section id="id1">
<h2>Usage<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Continue.py [-h] [-c C [C ...]] [-m M [M ...]]


optional arguments:
  -h, --help    show this help message and exit
  -c C [C ...]  Range/value of c_s^2 to consider, either in
                the form &lt;min&gt; &lt;max&gt; &lt;incr&gt; or a single
                value.
  -m M [M ...]  List of indices of the weights that are to
                be minimized. You can use -1 to refer to the
                last shell etc.
</pre></div>
</div>
<span class="target" id="module-Continue"></span><p>Contains routines to treat the case of infinitely many solutions.</p>
<dl class="simple">
<dt>Exit codes:</dt><dd><ul class="simple">
<li><p>0:   No optimal solution found</p></li>
<li><p>1:   Optimal solution found</p></li>
<li><p>127: General error</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="Continue.ParseArguments">
<span class="sig-prename descclassname"><span class="pre">Continue.</span></span><span class="sig-name descname"><span class="pre">ParseArguments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Continue.html#ParseArguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Continue.ParseArguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to parse command line options.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary of command line options</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Continue.Solve">
<span class="sig-prename descclassname"><span class="pre">Continue.</span></span><span class="sig-name descname"><span class="pre">Solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ReducedRhs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NumberOfRows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ShellSizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CsSquared</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinimizeWeights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Continue.html#Solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Continue.Solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the minimization problem via convex optimization.
See: <a class="reference external" href="https://www.cvxpy.org/">https://www.cvxpy.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>numpy.ndarray</em>) – Orthogonal matrix that results from the singular
value decomposition A=U.S.V</p></li>
<li><p><strong>ReducedRhs</strong> (<em>numpy.ndarray</em>) – Pruned matrix that has the inverse singular
values on the diagonal.</p></li>
<li><p><strong>NumberOfRows</strong> (<em>int</em>) – Number of rows of A</p></li>
<li><p><strong>ShellSizes</strong> (<em>list</em>) – List of shell sizes (int) NOT including zero shell</p></li>
<li><p><strong>CsSquared</strong> (<em>float</em>) – Speed of sound squared</p></li>
<li><p><strong>MinimizeWeights</strong> (<em>list</em>) – List of indices of the weights that shall be
minimized in the procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>cvxpy problem. Problem.status indicates</dt><dd><p>whether or not the problem could be solved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cvxpy.problems.problem.Problem</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-Functions">
<span id="functions-py"></span><h1>Functions.py<a class="headerlink" href="#module-Functions" title="Permalink to this headline">¶</a></h1>
<p>Collection of helper functions for LBweights.py and Continue.py</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Functions.LINEWIDTH">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">LINEWIDTH</span></span><a class="headerlink" href="#Functions.LINEWIDTH" title="Permalink to this definition">¶</a></dt>
<dd><p>Line width for console output.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Functions.QUIET">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">QUIET</span></span><a class="headerlink" href="#Functions.QUIET" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag to suppress standard output.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.AbsSquared">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">AbsSquared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Vector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#AbsSquared"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.AbsSquared" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the squared absolute value of numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Vector</strong> (<em>numpy.ndarray</em>) – Vector that is supposed to be squared</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the squared absolute value of Vector</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.AnalyzeTensorDimension">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">AnalyzeTensorDimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CurrentTensorRank</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#AnalyzeTensorDimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.AnalyzeTensorDimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive generation of lists that specify what types of tensors of rank
CurrentTensorRank are compatible with cubic invariance and also fully
symmetric under index exchange. For rank 2, these are just multiples of the
2nd rank unit tensor <img class="math" src="_images/math/20931d1a4317beeb02bf7ce2e6bf3411c2029bf3.png" alt="\delta_{ij}"/>. Thus tensor dimension is one.
For rank 4, these are multiples of <img class="math" src="_images/math/e4ddf50931b4459ad48ef721fafcb8c5b9dc6a26.png" alt="\delta_{ijkl}"/> and multiples of
<img class="math" src="_images/math/65d875ef743ad108b25a27b50931dbdd4f018d7b.png" alt="(\delta_{ij}"/>, <img class="math" src="_images/math/13b6bbba5336ebcb90dedb4624802b6dbbe6d428.png" alt="\delta_{kl} + \textrm{perm.})"/>. Thus tensor
dimension is two. For rank 6, we get another tensor
<img class="math" src="_images/math/e9b2dc262904def84fd2896d625bbdb843081737.png" alt="\delta_{ijklmn}"/>, but also all possible products of the lower-rank
deltas.
Hence tensor dimension is three. For each new (even) rank M we get another
delta with M indexes, plus all possible products of the lower-order delta
tensors So, for rank two we get <code class="docutils literal notranslate"><span class="pre">[[2]]</span></code> (1d) for rank four
<code class="docutils literal notranslate"><span class="pre">[[4],</span> <span class="pre">[2,2]]</span></code> (2d) for rank six <code class="docutils literal notranslate"><span class="pre">[[6],</span> <span class="pre">[4,2],</span> <span class="pre">[2,2,2]]</span></code> (3d) for rank
eight <code class="docutils literal notranslate"><span class="pre">[[8],</span> <span class="pre">[6,2],</span> <span class="pre">[4,4],</span> <span class="pre">[4,2,2],</span> <span class="pre">[2,2,2,2]]</span></code> (5d) and so on.
The routine takes care of that “and so on”. This is most easily done in a
recursive fashion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>CurrentTensorRank</strong> (<em>int</em>) – Tensor rank</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dimension of tensor space
list: List compatible tensors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.CloseEnough">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">CloseEnough</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RelTol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#CloseEnough"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.CloseEnough" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the condition</p>
<div class="math">
<p><img src="_images/math/cf427778d0b3cdc5c2c404d4d369284667e4a1be.png" alt="\left\lvert \sum_j A_{ij} w_j - b_i \right\rvert &amp;&lt;
\varepsilon \sqrt{\textstyle{\sum_j} \left(A_{ij} w_j\right)^2
+ \left(\frac{m_i}{2}\right)^2 b_i}
\text{ for all } i"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>numpy.ndarray</em>) – Matrix <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/></p></li>
<li><p><strong>W</strong> (<em>numpy.ndarray</em>) – Vector <img class="math" src="_images/math/27e9fb681b876c5850d1c7b0959e596f38783e61.png" alt="\vec{w}"/></p></li>
<li><p><strong>B</strong> (<em>numpy.ndarray</em>) – Vector <img class="math" src="_images/math/c5f6d51bcb27465bfd2c44756002d8a7f08977f3.png" alt="\vec{b},~b_i = c_\mathrm{s}^{m_i}"/></p></li>
<li><p><strong>M</strong> (<em>numpy.ndarray</em>) – Vector <img class="math" src="_images/math/e918f5636e26cfdcd96c97b2ce597eebfd98fc84.png" alt="\vec{m}"/></p></li>
<li><p><strong>RelTol</strong> (<em>float</em>) – Relative tolerance <img class="math" src="_images/math/cc7cc8f478074da39b2a04d286fe2444178ba85e.png" alt="\varepsilon"/></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if condition satisfied, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.ComputeSubshell">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">ComputeSubshell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#ComputeSubshell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.ComputeSubshell" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the (sub)shell that is being spanned by Velocity wrt. Group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Velocity</strong> (<em>numpy.ndarray</em>) – Velocity vector</p></li>
<li><p><strong>Group</strong> (<em>list</em>) – List of transformation matrices that form the cubic group</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of velocity vectors that form the velocity shell spanned by
Group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.Contains">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">Contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#Contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.Contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether given numpy array is contained in list. The all()
function is defined on numpy arrays and evaluates True if all elements are
True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Array</strong> (<em>numpy.ndarray</em>) – numpy array</p></li>
<li><p><strong>List</strong> (<em>list</em>) – List of numpy arrays</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if Array is contained in List, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.ContainsInSublist">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">ContainsInSublist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfLists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#ContainsInSublist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.ContainsInSublist" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether given numpy array is contained in a list of lists.
The all() function is defined on numpy arrays and evaluates True if all
elements are True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Array</strong> (<em>numpy.ndarray</em>) – numpy array</p></li>
<li><p><strong>List</strong> (<em>list</em>) – List of Lists of numpy arrays</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if Array is contained in ListOfLists, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.DoubleFactorial">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">DoubleFactorial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Number</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#DoubleFactorial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.DoubleFactorial" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Implementation of the double factorial.</dt><dd><p><img class="math" src="_images/math/b94b5b72651727ae6229d0237b83445549b9d8f2.png" alt="n!! = n(n-2)(n-4)\dots"/></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Number</strong> (<em>int</em>) – Number</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number <img class="math" src="_images/math/fb0ff6001a9864625bc5201811af825f76fa6e05.png" alt="!!"/></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.Echo">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">Echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">String</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#Echo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.Echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Formatted printing
If QUIET is set (i.e. via command line option –quiet) this is suppressed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>String</strong> (<em>str</em>) – String to be printed to the console</p></li>
<li><p><strong>Linewidth</strong> (<em>int</em>) – Maximum line width of console output</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.EchoError">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">EchoError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">String</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#EchoError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.EchoError" title="Permalink to this definition">¶</a></dt>
<dd><p>Formatted printing
Prints irregardless of value of QUIET</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>String</strong> (<em>str</em>) – String to be printed to the console</p></li>
<li><p><strong>Linewidth</strong> (<em>int</em>) – Maximum line width of console output</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.EnterWeights">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">EnterWeights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TotalNumberOfShells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#EnterWeights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.EnterWeights" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets vector of weights from user input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TotalNumberOfShells</strong> (<em>int</em>) – Number of shells INCLUDING zero-shell</p></li>
<li><p><strong>i_par</strong> (<em>int</em>) – Solution vector index (parametric solutions are written as
<img class="math" src="_images/math/13f596120112066a30b248b8fde4d2c5733ac420.png" alt="\vec{w} = \vec{w}_0 + \lambda_1 \vec{w}_1 + \lambda_2 \vec{w}_2 + \dots"/>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Vector of weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.EvaluateWeights">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">EvaluateWeights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W0List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SolutionMatrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CsSquared</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#EvaluateWeights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.EvaluateWeights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate numerical weights from their polynomial coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>W0List</strong> (<em>list</em>) – List of polynomial coefficients for zero shell</p></li>
<li><p><strong>SolutionMatrix</strong> (<em>numpy.ndarray</em>) – Solution matrix <img class="math" src="_images/math/90cab5ae70bdb6e45756490226ba488f522c4c4e.png" alt="Q"/></p></li>
<li><p><strong>CsSquared</strong> (<em>float</em>) – Speed of sound squared</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of numerical weights <img class="math" src="_images/math/15fd44652ef6c89b0704af175e6cde96ccd9ab6f.png" alt="[w_0, w_1, \dots]"/></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.FillLeftHandSide">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">FillLeftHandSide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SpacialDimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxTensorRank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfTensorDimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TotalNumberOfShells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GrandTotalList</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#FillLeftHandSide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.FillLeftHandSide" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the <img class="math" src="_images/math/eb6f7dc4f9140d5fef4cecff6cf4a3666f78f3c7.png" alt="R \times N_s"/> matrix <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SpacialDimension</strong> (<em>int</em>) – Spacial dimension</p></li>
<li><p><strong>MaxTensorRank</strong> (<em>int</em>) – Highest tensor rank (M) to consider.</p></li>
<li><p><strong>ListOfTensorDimensions</strong> (<em>list</em>) – List of the dimensions of tensor space
for tensors of rank <img class="math" src="_images/math/1f5276042aa372366e59546d60bf462ea62d1ce4.png" alt="2,4,\dots, M"/>.</p></li>
<li><p><strong>TotalNumberOfShells</strong> (<em>int</em>) – Total number of velocity shells <img class="math" src="_images/math/5e39e6f9d54fdbac1a3cad42723c4487d23b7598.png" alt="N_s"/></p></li>
<li><p><strong>GrandTotalList</strong> (<em>list</em>) – List of lists. The <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>-th sublist
contains all velocity vectors of shell <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.FillRightHandSide">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">FillRightHandSide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MaxTensorRank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfTensorDimensions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#FillRightHandSide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.FillRightHandSide" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the matrix <img class="math" src="_images/math/852ffd51b239076a617206b02e71e172064e2c93.png" alt="D: D_{r\mu} = \delta_{m_r \mu}"/></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MaxTensorRank</strong> (<em>int</em>) – Maximum tensor rank <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/></p></li>
<li><p><strong>ListOfTensorDimensions</strong> (<em>list</em>) – List of the dimensions of tensor space
for tensors of rank <img class="math" src="_images/math/1f5276042aa372366e59546d60bf462ea62d1ce4.png" alt="2,4,\dots, M"/>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix <img class="math" src="_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.FindRangeOfExistence">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">FindRangeOfExistence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W0List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SolutionMatrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#FindRangeOfExistence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.FindRangeOfExistence" title="Permalink to this definition">¶</a></dt>
<dd><p>Make use of the function “roots” that needs the coefficients in reverse
order, in order to find the roots of the weight polynomials. If inbetween
two roots all weights are positive, add them to list CompressedRoots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>W0List</strong> (<em>list</em>) – List of polynomial coefficients for zero shell</p></li>
<li><p><strong>SolutionMatrix</strong> (<em>numpy.ndarray</em>) – Solution matrix <img class="math" src="_images/math/90cab5ae70bdb6e45756490226ba488f522c4c4e.png" alt="Q"/></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List CompressedRoots of roots that form valid intervals for
the speed of sound.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.FindVelocities">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">FindVelocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SpacialDimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SquaredVelocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#FindVelocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.FindVelocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans the cubic lattice for lattice velocity with squared length
SquaredVelocity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SpacialDimension</strong> (<em>int</em>) – SpacialDimension</p></li>
<li><p><strong>SquaredVelocity</strong> (<em>int</em>) – Squared length of compatible lattice velocities</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of compatible lattice velocity vectors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.Frexp10">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">Frexp10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#Frexp10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.Frexp10" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exponent and mantissa in base 10</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Float</strong> (<em>float</em>) – Original number</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">(Mantissa,</span> <span class="pre">Exponent)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.GetGroup">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">GetGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SpacialDimension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#GetGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.GetGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the cubic group. Each transformation matrix in the group is made
up of 2d unit vectors of type <img class="math" src="_images/math/bfe492734b025873d18bf89d0ac91e0d32dd8358.png" alt="(0\dots0,+-1,0\dots0)"/>.
We will identify a vector with i-th component 1 and 0 elsewhere by the
number <img class="math" src="_images/math/5aa339d4daf45a810dda332e3c80a0698e526e04.png" alt="i"/>. A vector with <img class="math" src="_images/math/5aa339d4daf45a810dda332e3c80a0698e526e04.png" alt="i"/>-th component -1 and 0 elsewhere
is identified by the number <img class="math" src="_images/math/af83d7347a690f454e058fc2058a41b6de3e21b4.png" alt="-i"/>.
The cubic group then consists of all orthogonal matrices, with columns
made up of the above unit vectors.
In general there are <img class="math" src="_images/math/994240e3b461f41bcf4fee08601aa7077269a07e.png" alt="d! 2^d"/> such transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>SpacialDimension</strong> (<em>int</em>) – Spacial dimension</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of all transformation matrices in the cubic group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.GetListOfSubshells">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">GetListOfSubshells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Shell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#GetListOfSubshells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.GetListOfSubshells" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies all group transformations to all velocities in shell and returns
all distinct shells that result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Shell</strong> (<em>list</em>) – List of velocity vectors</p></li>
<li><p><strong>Group</strong> (<em>list</em>) – List of transformation matrices that form the cubic group</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of distinct velocity shells</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.IndicatorFunction">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">IndicatorFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W0List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SolutionMatrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CsSquared</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#IndicatorFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.IndicatorFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests, whether solution yields all positive weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>W0List</strong> (<em>list</em>) – List of polynomial coefficients for zero shell</p></li>
<li><p><strong>SolutionMatrix</strong> (<em>numpy.ndarray</em>) – Solution matrix <img class="math" src="_images/math/90cab5ae70bdb6e45756490226ba488f522c4c4e.png" alt="Q"/></p></li>
<li><p><strong>CsSquared</strong> (<em>float</em>) – Speed of sound squared</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if all weights positive, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.LatticeSum">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">LatticeSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RandomVector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfVelocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TensorRank</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#LatticeSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.LatticeSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the sum
<img class="math" src="_images/math/f5b769ec2073a34fe538f3736388a75ddf847203.png" alt="A_{rs} = \frac{1}{(m_r-1)!!} \sum_{i \in s} (\vec{c}_i\cdot\vec{n}_r)^{m_r}"/></p>
<p>for tensor rank <img class="math" src="_images/math/79a3d439d28652c547386f39b555d90d3aaf102d.png" alt="r"/> and shell <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RandomVector</strong> (<em>numpy.ndarray</em>) – <img class="math" src="_images/math/79a3d439d28652c547386f39b555d90d3aaf102d.png" alt="r"/>-th random unit vector</p></li>
<li><p><strong>ListOfVelocities</strong> (<em>list</em>) – List of velocity vectors in shell <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/></p></li>
<li><p><strong>TensorRank</strong> (<em>int</em>) – Tensor rank <img class="math" src="_images/math/79a3d439d28652c547386f39b555d90d3aaf102d.png" alt="r"/></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><img class="math" src="_images/math/11935555694939059a5236d977583d9a20c0cb00.png" alt="A_{rs}"/></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.MakeRandomVector">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">MakeRandomVector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SpacialDimension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#MakeRandomVector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.MakeRandomVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random vector uniformly distributed on the unit sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>SpacialDimension</strong> (<em>int</em>) – Spacial dimension d</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Vector of length one with random orientation in d-dimensional
space.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.OutputRangeOfExistence">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">OutputRangeOfExistence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CompressedRoots</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#OutputRangeOfExistence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.OutputRangeOfExistence" title="Permalink to this definition">¶</a></dt>
<dd><p>Screen output of the intervals of the speed of sound that yield all
positive weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>CompressedRoots</strong> (<em>list</em>) – List of roots that form valid intervals for
the speed of sound.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of valid intervals</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.ParseArguments">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">ParseArguments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#ParseArguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.ParseArguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to parse command line options.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary of command line options</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.RatApprox">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">RatApprox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#RatApprox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.RatApprox" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates numerator and denominator for a floating point number x and
returns the output as a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – Number to approximate as fraction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Approximate fraction as string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.TestSolution">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">TestSolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GrandTotalList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxTensorRank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SpacialDimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ListOfTensorDimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Solution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RelTol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#TestSolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.TestSolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Test validity of the equation <img class="math" src="_images/math/2fb1b334f42eb13db372ed7a05db19c80db77f24.png" alt="A\vec{w} = \vec{b}"/> for given
weights w and speed of sound <img class="math" src="_images/math/b10e35c2723ef1b7b6a127e3851f39a312813e1d.png" alt="c_s^2"/>.
A solution is deemed valid, if</p>
<div class="math">
<p><img src="_images/math/b81c6d8cb6a3f38204399e6547e28fcba50d0b2f.png" alt="\left\lvert \sum_j A_{ij} w_j - b_i \right\rvert
&amp;&lt; \varepsilon_0
+ \varepsilon \sqrt{\left(\textstyle{\sum_j} A_{ij} w_j\right)^2
+ \left(\frac{m_i}{2}\right)^2 b_i}
\text{ for all } i"/></p>
</div><p>The weights can be given as a linear parametric equation</p>
<div class="math">
<p><img src="_images/math/2d313918d8e26e64c6c1cbc518afa6d8f0be1b9b.png" alt="\vec{w} = \vec{w}_0 + \lambda_1 \vec{w}_1 + \lambda_2 \vec{w}_2 +
\dots"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GrandTotalList</strong> (<em>list</em>) – List of lists. The <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>-th sublist
contains all velocity vectors of shell <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>.</p></li>
<li><p><strong>MaxTensorRank</strong> (<em>int</em>) – Maximum tensor rank <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/></p></li>
<li><p><strong>SpacialDimension</strong> (<em>int</em>) – SpacialDimension</p></li>
<li><p><strong>ListOfTensorDimensions</strong> (<em>list</em>) – List of the dimensions of tensor space
for tensors of rank <img class="math" src="_images/math/1f5276042aa372366e59546d60bf462ea62d1ce4.png" alt="2,4,\dots, M"/>.</p></li>
<li><p><strong>Solution</strong> (<em>list</em>) – Solution that is to be tested in the form
<code class="docutils literal notranslate"><span class="pre">[CsSquared,</span> <span class="pre">[[w_00,</span> <span class="pre">w_01,...],</span> <span class="pre">[[w_10,</span> <span class="pre">w_11,</span> <span class="pre">...],</span> <span class="pre">...]</span></code>
If None is given, the user is prompted to enter a solution by hand.</p></li>
<li><p><strong>RelTol</strong> (<em>float</em>) – Relative tolerance <img class="math" src="_images/math/cc7cc8f478074da39b2a04d286fe2444178ba85e.png" alt="\varepsilon"/></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 if solution is valid, otherwise 1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.ToMatrix">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">ToMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#ToMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.ToMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an array of unit vector representations to proper matrix.
For example
<code class="docutils literal notranslate"><span class="pre">[0,2,1]</span></code> will be converted to
<code class="docutils literal notranslate"><span class="pre">[[1,0,0],</span> <span class="pre">[0,0,1],</span> <span class="pre">[0,1,0]]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Array</strong> (<em>numpy.ndarray</em>) – Array of integers</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Transformation matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.Type">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">Type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Shell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#Type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.Type" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to determine typical velocity vector for Shell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Shell</strong> (<em>list</em>) – List of velocity vectors, e.g. <code class="docutils literal notranslate"><span class="pre">[[0,1],[1,0]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Typical velocity vector, e.g. <code class="docutils literal notranslate"><span class="pre">(0,1)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.WriteLatexNumber">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">WriteLatexNumber</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rational</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#WriteLatexNumber"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.WriteLatexNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Write Value to <code class="docutils literal notranslate"><span class="pre">Outfile</span></code> in a Latex compatible way</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Value</strong> (<em>float</em>) – Value</p></li>
<li><p><strong>Outfile</strong> – Output file</p></li>
<li><p><strong>Precision</strong> (<em>int</em>) – Number of digits</p></li>
<li><p><strong>Rational</strong> (<em>bool</em>) – Approximate numbers by fractions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.WriteLatexTables">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">WriteLatexTables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CompressedRoots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W0List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SolutionMatrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GrandTotalList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxTensorRank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rational</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latex_tables.tex'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#WriteLatexTables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.WriteLatexTables" title="Permalink to this definition">¶</a></dt>
<dd><p>Write unique solution to a file in form of a latex table. This will
append to any existing file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>CompressedRoots</strong> (<em>list</em>) – List of roots that form the valid intervals for
the speed of sound</p></li>
<li><p><strong>W0List</strong> (<em>list</em>) – List of polynomial coefficients for zero shell</p></li>
<li><p><strong>SolutionMatrix</strong> (<em>numpy.ndarray</em>) – Solution matrix <img class="math" src="_images/math/90cab5ae70bdb6e45756490226ba488f522c4c4e.png" alt="Q"/></p></li>
<li><p><strong>GrandTotalList</strong> (<em>list</em>) – List of lists. The <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>-th sublist
contains all velocity vectors of shell <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>.</p></li>
<li><p><strong>MaxTensorRank</strong> (<em>int</em>) – Maximum tensor rank <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/></p></li>
<li><p><strong>Precision</strong> (<em>int</em>) – Number of digits</p></li>
<li><p><strong>Rational</strong> (<em>bool</em>) – Approximate numbers by fractions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Functions.YesNo">
<span class="sig-prename descclassname"><span class="pre">Functions.</span></span><span class="sig-name descname"><span class="pre">YesNo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Question</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Functions.html#YesNo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Functions.YesNo" title="Permalink to this definition">¶</a></dt>
<dd><p>Ask for yes or no answer and return a Boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Question</strong> (<em>str</em>) – String that is printed when function is called.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True, if answer is in <code class="docutils literal notranslate"><span class="pre">[&quot;YES&quot;,</span> <span class="pre">&quot;Y&quot;,</span> <span class="pre">&quot;yes&quot;,</span> <span class="pre">&quot;y&quot;,</span> <span class="pre">&quot;Yes&quot;,</span> <span class="pre">\CR]</span></code>
False, if answer is in <code class="docutils literal notranslate"><span class="pre">[&quot;NO&quot;,</span> <span class="pre">&quot;N&quot;,</span> <span class="pre">&quot;no&quot;,</span> <span class="pre">&quot;n&quot;,</span> <span class="pre">&quot;No&quot;]</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">LBweights</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Burkhard Dünweg, Dominic Spiller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>